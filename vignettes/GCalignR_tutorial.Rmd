---
title: "Aligning Peaks: A Tutorial"
author: "Meinolf Ottensmann, Martin A. Stoffel, Joseph Hoffman"
output: rmarkdown::html_vignette
bibliography: bibliography.bib
vignette: >
  %\VignetteIndexEntry{"Aligning Peaks: A Tutorial"}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo = FALSE}
library(knitr)
library(GCalignR)
knitr::opts_chunk$set(collapse = TRUE, comment = "#>", cache = FALSE,
    fig.width = 7, fig.height = 7) # warning = FALSE
```

## Summary
During the alignment procedure of peak data derived from gas-chromatograpy the user needs to make certain decisions that alter the final outcome. These include the appropriate definition of three paramters which exert a major influence on the alignment of retention times. Therefore, GCalignR incorporates diagnostic plots that are intended to assist the user in assessing the goodness of an alignment and revising alignment parameters in GCalignR as well as peak calling parameters in preceding tools if necessary. This document provides a comprehensive tutorial how to use these functionalities for the choosing and revising alignment parameters based on a dataset that is comprised of chemical signatures that have been obtained by sampling the skin of Antarctic fur seals *Arctocephalus gazella* [@stoffel2015chemical]. For a quick overview we refer to \href{../doc/GCalignR_step_by_step.html}{GCalignR Step by Step}.

## Load the data
```{r}
library(GCalignR)
data("peak_data")
data <- peak_data[1:10] # Ten samples for faster compuation
```

## A first alignment
```{r, cache = TRUE}
align_1 <- align_chromatograms(data = data,conc_col_name = "area",rt_col_name = "time") 
```
```{r}
plot(align_1)
```

## Using Heatmaps
Heatmaps can be used to visualise a large dataset at a glance but allow to explore the data in detail as well. 

```{r, cache = TRUE}
GCalignR::gc_heatmap(object = aligned_peak_data, type = "discrete",label = T)
``` 

## References
